<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ“š Reading Dashboard - Test</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>ðŸ“š Reading Dashboard - Test Version</h1>
        </header>

        <!-- Reading Goal Progress -->
        <section class="goal-section">
            <div class="goal-card">
                <h2>2025 Reading Goal</h2>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-bar"></div>
                    </div>
                    <div class="progress-text" id="progress-text">
                        Loading...
                    </div>
                </div>
                <div class="goal-stats">
                    <div class="stat">
                        <span class="stat-value" id="books-this-month">-</span>
                        <span class="stat-label">this month</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="pages-per-day">-</span>
                        <span class="stat-label">pages/day</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Stats Overview -->
        <section class="stats-section">
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-number" id="books-completed">-</span>
                    <span class="stat-label">Books Read (2025)</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="books-reading">-</span>
                    <span class="stat-label">Currently Reading</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="total-pages">-</span>
                    <span class="stat-label">Pages Read (2025)</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="avg-pages-per-day">-</span>
                    <span class="stat-label">Avg Pages/Day</span>
                </div>
            </div>
        </section>
    </div>

    <script>
    // Simulated books data - using actual count we know is correct
    const testBooks = [];
    
    // Add 26 books for 2025 (we know this is the correct count)
    for (let i = 1; i <= 26; i++) {
        testBooks.push({
            "Title": `Test Book ${i}`,
            "Author": "Test Author",
            "Shelf": "read",
            "Date Read": `2025/0${i < 10 ? '0' + i : i > 31 ? '07' : '01'}/${i < 10 ? '0' + i : i > 31 ? i - 30 : i}`,
            "Number of Pages": 300 + i * 10
        });
    }
    
    // Add a few currently reading books
    testBooks.push({
        "Title": "Currently Reading Book 1",
        "Author": "Test Author",
        "Shelf": "currently-reading",
        "Date Read": "",
        "Number of Pages": 400
    });
    
    class TestReadingTracker {
        constructor() {
            this.books = testBooks;
            this.goal = 90;
            this.renderDashboard();
        }
        
        renderDashboard() {
            this.renderStats();
            this.renderProgress();
        }
        
        renderStats() {
            console.log('Total books loaded:', this.books.length);
            
            const completed2025 = this.books.filter(book => 
                book.Shelf === 'read' && 
                book['Date Read'] && 
                book['Date Read'].startsWith('2025')
            );
            
            console.log('Books completed in 2025:', completed2025.length);
            
            const currentlyReading = this.books.filter(book => 
                book.Shelf === 'currently-reading'
            ).length;
            
            const totalPages2025 = completed2025.reduce((sum, book) => sum + (book['Number of Pages'] || 0), 0);
            
            // Update elements
            const booksCompletedEl = document.getElementById('books-completed');
            const booksReadingEl = document.getElementById('books-reading'); 
            const totalPagesEl = document.getElementById('total-pages');
            const pagesPerDayEl = document.getElementById('pages-per-day');
            const avgPagesPerDayEl = document.getElementById('avg-pages-per-day');
            
            if (booksCompletedEl) booksCompletedEl.textContent = completed2025.length;
            if (booksReadingEl) booksReadingEl.textContent = currentlyReading;
            if (totalPagesEl) totalPagesEl.textContent = totalPages2025.toLocaleString();
            
            const startOfYear = new Date(2025, 0, 1);
            const daysSinceStart = Math.floor((new Date() - startOfYear) / (1000 * 60 * 60 * 24));
            const pagesPerDay = daysSinceStart > 0 ? Math.round(totalPages2025 / daysSinceStart) : 0;
            if (pagesPerDayEl) pagesPerDayEl.textContent = pagesPerDay;
            if (avgPagesPerDayEl) avgPagesPerDayEl.textContent = pagesPerDay;
            
            const booksThisMonth = this.books.filter(book => 
                book.Shelf === 'read' && 
                book['Date Read'] && 
                book['Date Read'].startsWith('2025/07')
            ).length;
            
            const booksThisMonthEl = document.getElementById('books-this-month');
            if (booksThisMonthEl) booksThisMonthEl.textContent = booksThisMonth;
        }
        
        renderProgress() {
            const completed = this.books.filter(book => 
                book.Shelf === 'read' && 
                book['Date Read'] && 
                book['Date Read'].startsWith('2025')
            ).length;
            const progressPercentage = Math.min((completed / this.goal) * 100, 100);
            
            console.log('renderProgress: completed =', completed, 'goal =', this.goal, 'percentage =', progressPercentage);
            
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            
            console.log('renderProgress: progressBar =', progressBar, 'progressText =', progressText);
            
            if (progressBar) {
                progressBar.style.width = `${progressPercentage}%`;
                console.log('renderProgress: set progressBar width to', `${progressPercentage}%`);
            }
            
            if (progressText) {
                progressText.textContent = `${completed} of ${this.goal} books (${Math.round(progressPercentage)}%)`;
                console.log('renderProgress: set progressText to', `${completed} of ${this.goal} books (${Math.round(progressPercentage)}%)`);
            }
        }
    }
    
    // Initialize when DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
        console.log('DOM loaded, initializing test tracker...');
        new TestReadingTracker();
    });
    </script>
</body>
</html>
